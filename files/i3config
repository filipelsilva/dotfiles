# Should you change your keyboard layout some time, delete
# this file and re-run i3-config-wizard(1).

# i3 config file (v4)
# Please see https://i3wm.org/docs/userguide.html for a complete reference!

# System startup and other configs {{{

# Detect monitors and apply wallpaper
exec_always --no-startup-id autorandr --change --skip-options crtc && feh --bg-fill $HOME/dotfiles/wallpapers/arch.webp

# Optimus-manager
exec_always --no-startup-id optimus-manager-qt

# Disable suspension
exec_always --no-startup-id xset s off && xset -b -dpms

# xss-lock grabs a logind suspend inhibit lock and will use i3lock to lock the
# screen before suspend. Use loginctl lock-session to lock your screen.
exec --no-startup-id xss-lock --transfer-sleep-lock -- i3lock --nofork

# NetworkManager is the most popular way to manage wireless networks on Linux,
# and nm-applet is a desktop environment-independent system tray GUI for it.
exec --no-startup-id nm-applet

# Use pactl to adjust volume in PulseAudio.
set $refresh_i3status killall -SIGUSR1 i3status
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +5% && $refresh_i3status
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -5% && $refresh_i3status
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle && $refresh_i3status
bindsym XF86AudioMicMute exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status

# Media keys
bindsym XF86AudioPlay exec --no-startup-id playerctl play-pause
bindsym XF86AudioPause exec --no-startup-id playerctl play-pause
bindsym XF86AudioStop exec --no-startup-id playerctl stop
bindsym XF86AudioNext exec --no-startup-id playerctl next
bindsym XF86AudioPrev exec --no-startup-id playerctl previous

# Adjust brightness
bindsym XF86MonBrightnessUp exec --no-startup-id brightnessctl set 5%+
bindsym XF86MonBrightnessDown exec --no-startup-id brightnessctl set 5%-
# }}}

# Modifier key
set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:Iosevka SS12 10

# Colors {{{
set $background #1d2021
set $foreground #ebdbb2
set $black      #282828
set $red        #cc241d
set $green      #98971a
set $yellow     #d79921
set $blue       #458588
set $magenta    #b16286
set $cyan       #689d6a
set $white      #a89984
# }}}

# Keybinds and settings {{{

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# Kill focused window
bindsym $mod+Shift+q kill

# Start a terminal
bindsym $mod+Return exec alacritty

# Start a file manager
bindsym $mod+e exec thunar

# Start dmenu
bindsym $mod+d exec --no-startup-id dmenu_run -fn "Iosevka SS12-10"\
        -nf '$white' -nb '$background' -sf '$black' -sb '$blue'

# Split in horizontal orientation
bindsym $mod+s split h

# Split in vertical orientation
bindsym $mod+v split v

# Enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# Change container layout (stacked, tabbed, toggle split)
bindsym $mod+Shift+s layout toggle
bindsym $mod+Shift+Mod1+s layout toggle split

# Toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# Change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# Size of floating windows
floating_minimum_size 75 x 50
floating_maximum_size 800 x 600

# Focus the parent container
bindsym $mod+a focus parent

# Focus the child container
bindsym $mod+Shift+a focus child

# No window names
#for_window [class=".*"] border pixel 1

# Hide borders if only one window is visible
hide_edge_borders smart

# Focus doesn't follow mouse
focus_follows_mouse no

# Mouse doesn't go to the center of outputs
mouse_warping none
# }}}

# Focusing and moving windows {{{

# Change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# Move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right
# }}}

# Workspaces {{{

# Define names for default workspaces for which we configure key bindings later on.
# We use variables to avoid repeating the names in multiple places.
set $ws1 "1"
set $ws2 "2"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws10 "10"

# Switch to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws10

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $ws1
bindsym $mod+Shift+2 move container to workspace $ws2
bindsym $mod+Shift+3 move container to workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6
bindsym $mod+Shift+7 move container to workspace $ws7
bindsym $mod+Shift+8 move container to workspace $ws8
bindsym $mod+Shift+9 move container to workspace $ws9
bindsym $mod+Shift+0 move container to workspace $ws10

# Move more quickly between workspaces
bindsym $mod+Tab workspace next

# Switch between the current and the previously focused one
bindsym $mod+b workspace back_and_forth
bindsym $mod+Shift+b move container to workspace back_and_forth

# Move the whole workspace to the next output
bindsym $mod+x move workspace to output right
# }}}

# Reload the configuration file
bindsym $mod+Shift+r reload

# Restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+Mod1+r restart

# MODE: Reboot, shutdown, exit i3 {{{
mode "(r)eboot, (s)hutdown, (e)xit i3" {
        bindsym r exec --no-startup-id reboot
        bindsym s exec --no-startup-id shutdown -h now
        bindsym e exec --no-startup-id i3-msg exit

        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+q mode "default"
}

bindsym $mod+q mode "(r)eboot, (s)hutdown, (e)xit i3"
# }}}

# MODE: Change keyboard layout {{{
mode "[(P)T] [(U)S] (i)ntl, (a)ltgr-intl" {
        bindsym p exec setxkbmap -layout pt; mode "default"
        bindsym u exec setxkbmap -layout us; mode "default"
        bindsym i exec setxkbmap -layout us -variant intl; mode "default"
        bindsym a exec setxkbmap -layout us -variant altgr-intl; mode "default"

        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+p mode "default"
}

bindsym $mod+p mode "[(P)T] [(U)S] (i)ntl, (a)ltgr-intl"
# }}}

# MODE: Printscreen {{{
mode "[Printscreen] (s)election, (a)ctive window, (w)hole screen" {
        bindsym s exec --no-startup-id maim --select "$HOME/Pictures/$(date).png"; mode "default"
        bindsym a exec --no-startup-id maim --window $(xdotool getactivewindow) "$HOME/Pictures/$(date).png"; mode "default"
        bindsym w exec --no-startup-id maim "$HOME/Pictures/$(date).png"; mode "default"

        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym Print mode "default"
}

bindsym Print mode "[Printscreen] (s)election, (a)ctive window, (w)hole screen"
# }}}

# MODE: Resize window {{{
mode "resize" {
        bindsym h resize shrink width 5 px or 5 ppt
        bindsym j resize grow height 5 px or 5 ppt
        bindsym k resize shrink height 5 px or 5 ppt
        bindsym l resize grow width 5 px or 5 ppt
        bindsym Left resize shrink width 5 px or 5 ppt
        bindsym Down resize grow height 5 px or 5 ppt
        bindsym Up resize shrink height 5 px or 5 ppt
        bindsym Right resize grow width 5 px or 5 ppt

        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+r mode "default"
}

bindsym $mod+r mode "resize"
# }}}

# Theme {{{
bar {
        tray_output primary
        position bottom
        status_command i3status

        colors {
                background $background
                statusline $foreground
                separator  $white
                
                # border|background|text
                focused_workspace  $black $black $blue
                active_workspace   $black $black $magenta
                inactive_workspace $black $black $white
                urgent_workspace   $red $black $red
        }
}

# Container colors
# border|background|text|indicator|child_border
client.focused          $blue $blue $black $magenta $blue
client.focused_inactive $black $black $yellow $magenta $black
client.unfocused        $black $black $yellow $magenta $black
client.urgent           $red $red $white $red $red
# }}}
